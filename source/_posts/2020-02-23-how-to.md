-----
title: 如何在这里撰写博客
date: 2020-02-23
categories: 技术
tags: 
    - hexo
    - 如何写博客
-----

<!-- toc -->

这篇文章主要介绍如何在一台新电脑上基于此博客开始文章撰写，它一点都不复杂~
但为了避免它变成流水账，同时让读者清楚原理，可能会啰嗦一些。
同时由于能力有限，内容不见得完全正确，方法也可能不是最优的。

这篇文章的适用对象是能够熟练使用电脑、理解概念、主动搜索，但对编程无太多概念的用户。

好了，开始吧~

## 背景

整个站点是基于`Hexo`工具构建，托管于免费的`Github Pages`. 

下面我们先简单介绍网页和服务器，然后引出我们的Hexo和Github Pages.

不严谨地说，网页由 `HTML文件 + 资源` 构成。HTML是`HyperText Markup Language`的缩写，
其中`HyperText`其实对应这万维网`www`的基础协议`http`中的HyperText，说明HTML一开始就是为了万维网而出现的。
而`Markup Language`表示它是一种标记语言。所谓标记，可以搜索看看，
或者在[标记语言-维基百科](https://zh.wikipedia.org/wiki/%E7%BD%AE%E6%A0%87%E8%AF%AD%E8%A8%80) 查看，
可以简单认为 `文本 + 预定义标签` 的组合，这种组合可以表示结构化的信息。
`资源`，包括但不限于图片、视频、样式(css)、脚本(Javascript)、flash等。HTML文件通过一些标签描述这些资源的信息。

我们看到的任何一个网页，都是由HTML语言来组织的。下面的例子是一个最简单的规范HTML源代码：

```html
<!DOCTYPE html>
<html>
<head>
    <title>Hello World</title>
</head>
<body>
    Wellcome to <a href="http://sparrowhole.github.io">Sparrowhole</a>, 
    I love clover.
    <img title="clover image" src="http://a.b.com/clover.png" />
</body>
</html>
```

以上，`<>` 包裹的内容可以算作标签， 如`<title> ... </title>`表示包裹的内容是标题，而`<img ... />`则表示了图片的信息。

HTML仅仅是一段代码，而我们平时看到的网页，都是通过`浏览器`*渲染*出来的。浏览器基于标签，去渲染文字（如设置大小，位置），
获取资源并展示（如基于链接下载图片到本地，然后显示图片）。在浏览器中，我们可以通过`右键 -> 查看网页源码`来查看HTML代码，
通常，它看起来都非常复杂的。

以上，我们知道了`网页`的本质：通过HTML文件来组织资源，然后浏览器来渲染，我们就看到了网页。

> PS： 我们平时用的WORD软件，其实一定程度上就可以看做`编辑器 + 浏览器`的组合；而`.docx`，其实就是`html + 资源`的压缩包。
> 不信的话，可以把`.docx`用解压缩软件打开看看~

有了网页，其实我们自己就可以直接通过浏览器访问了。但是，要想全世界的人都能看，还需要`部署`（托管）。
其实就是把自己电脑上的网页和资源放到**别人的机器**上，而且这个机器**所有人都能够访问**到。
一般称这个机器为服务器，称访问机器的地址为 **(超)链接**，可以认为就是网址。

博客(Blog)是互联网上的一种内容展现形式，它的出现，赋予了普通个体发声的能力。
随着互联网演进，博客从最初的新潮（*部落格*~），到大众，再到如今式微。
构建博客的工具也发生了一些改变，倒退十年主流还是使用*新浪博客*等平台来发布内容，
而后渐渐优质内容从平台转向了个体，使用独立站点托管博客的时代来临。
自我感觉，这种趋势的改变，代表着博客主对个人品牌和内容本身的关注。对个体生活、思想的展现，对世界的积极思考，对价值和时间的记录，
是博客的灵魂所在，这点应该从未改变。而博客构建工具的改变，代表了博客主对内容土壤的选择。

**Hexo** 是近几年流行的一款博客构建工具。它的中文官方网站是 [https://hexo.io/zh-cn/](https://hexo.io/zh-cn/). 
它的作用是完成网页的生成。用户只需要撰写简单的`Markdown`文本（类似纯文本），通过hexo处理，就可以自动生成网页。
它极大简化了内容的构建难度，让创作者能够关注内容本身。

**Github Pages**是一个目前免费的内容托管平台，是属于`Github`的一个项目。通常，它周围聚集的都是程序员群体，
故而技术主题的博客是主流。它最大的缺点是国内访问速度慢，甚至可能无法访问。

我们通过`Hexo`来撰写博客，然后发布到`Github Pages`，从而让内容得以传播到每一个有兴趣的人那里。

## 当前博客的搭建过程

最开始，我们利用Hexo工具在本地初始化了一个博客文件夹，
然后选择了[polarbear](https://github.com/frostfan/hexo-theme-polarbear)
作为博客的主题，在其基础上做了轻微改动。Polarbear非常简洁，专注于内容展现，非常感谢[作者](https://d2fan.com/)。

接着，我们基于[寻图标](https://icon.52112.com/icon/1459635.html)利用PS勉强copy了一份，作为网站的图标。
如果这里涉及版权纠纷，还请告知替换而非起诉……

最后，在`github.com`上创建了`sparrow.github.io`仓库，并将hexo创建的源代码文件夹上传到该仓库的`source`分支，
并在`travis-ci.com`上构建了一个在线`hexo generate`的命令，它拉取github上的源代码，做hexo编译生成网页，
然后再推送到此仓库的master分支上。这个过程几经波折，但最终顺利完成。

最后，浏览器输入 `sparrowhole.github.io`，博客出现了，搭建成功！

## 正式开始撰写

下面是这篇文章的核心内容。在一台全新电脑上撰写博客，过程可以分为3大步，分别是

1. 创建工作环境 （仅第一次撰写时需要）
2. 撰写文章
3. 发布文章

接下来逐步介绍。

### 1. 创建工作环境

该步骤是从Github上下载博客代码到本地电脑，以下载的代码为基础，我们才能开始后续步骤。该步骤只需做一次，后续无需重复下载。

在下载之前，我们先介绍一下基础知识。

通常来说，Github是代码托管软件，但其实你可以拿它来存各种东西，也就是说，它算是一个速度不太快的网盘。
但这个*网盘*与普通的直接存文件的网盘（如百度网盘）不同，它在网页侧不提供直观易用的上传按钮，因此最好用`同步软件`来更新。
`git`是`Github`的一种同步软件。它具有拉取数据、上传数据的功能，通过它，就可以完成博客代码的下载和上传了。其实，先有git，才有github. 
git本质上是**版本控制**软件——每次更新了内容，我们可以通过git记录更新的变化，也就自动创建了一个版本。
这样的好处就是我们可以任意的回到过去的某个版本、轻松地查看版本历史、查看任意两个版本的改动。总之，它保留了编辑历史，让我们的数据更加安全可回溯。
但是，即使有了版本控制，如果我们本地的数据被误删除了，或者磁盘坏了，那数据依然是不安全的——于是云备份成为了合理的选择。
而Github就是配合git的一个云备份网站。

vscode是一款易用强大的编辑器，同时内置git命令支持，我们后续将利用它来写作博客，并且同步到Github。但是它不支持直接下载代码，
所以我们要利用单独的git工具完成下载功能。

以上，我们知道了3个关键点： 

1. Github是用来存代码/数据的
2. 需要用git来在Github和本地电脑间同步数据
3. 博客写作、同步用vscode,但是它本身不支持下载代码，需要格外的git工具先把代码下载下来

所以，接下来，我们要

1. 先下载并安装额外git工具
2. 利用git工具将Github上的博客代码下载到本地
3. 安装vscode，打开本地目录，完成准备工作

一步一步来：

1. 下载并安装git工具

    从 [git-scm](https://git-scm.com/download) 可以下载到git工具. 
    下载Windows版本(64-bit for Windows setup版本)，如果无法下载或者下载慢，可以直接点击
    [这个链接](http://npm.taobao.org/mirrors/git-for-windows/v2.25.0.windows.1/Git-2.25.0-64-bit.exe)
    下载（是淘宝克隆的源，感谢淘宝）。
    
    然后正常双击文件开始安装。需要说明如下页面的设置：

    ![git-install-select-components](/images/2020-02-23-how-to/git_install_select1.png)

    把`Windows Explore integration`**去掉勾选**，否则Windows右键就会出现相关命令，没有必要。

    除此之外，直接next就好了。最后一步next完，理论上就安装好了git！

    我们在Windows程序列表中找到Git, 或者直接`Windows + R`搜索到git，选择`Git GUI`，如果可以打开，那么恭喜你，它真的安装好了！

2. 利用git工具将Github的博客代码下载到本地

    首先打开上面说的`Git GUI`，非常简陋的UI里，有3个选项，分别是 `Create New Repository`, `Clone Existing Repository`,
    `Open Existing Repository`.

    解释一下这个*Repository*, 中文一般翻译为`仓库`，通常也简称为*repo*.
    repo是git管理的对象，而它从文件的视角来看，其实对应到整个项目的文件夹。
    在这里，我们的博客代码，就是一个repo, 它下载下来存储为一个文件夹。

    我们点击`Clone Existing Repository`, 因为仓库已经建好了，放在Github上啦，`Clone`就是把它下到本地。
    点击按钮后，会要填两个框，分别是

    1. Source Location: 仓库的远端地址。这个我们要从Github上获取。

        打开仓库链接，这里是 [sparrowhole.github.io](https://github.com/sparrowhole/sparrowhole.github.io)，
        如果需要登录，请登录。
        然后点击**绿绿*的那个`Clone or download`, 会出现一个地址框，里面的地址就是这个source location. 
        点击地址框右边的剪贴板图标，直接就把这个地址复制下来了！

        ![clone-or-download](/images/2020-02-23-how-to/git_clone_source.png)        
        
        然后粘贴到*Source Location*的框里。

        它的值应该是 `https://github.com/sparrowhole/sparrowhole.github.io.git`,
        其实可以直接把上面这个值放进去，但是了解一下整个过程是好的。

    2. Target Direcotry: 仓库本地目录，也就是本地放在哪里。

        直接点击框右边的`Browse`按钮，选择/新建一个喜欢的地址（不要有中文），然后点`选择文件夹`，就可以了。
        这个文件夹是我们仓库目录的父目录。这里假设选择的文件夹路径是`PARENT_DIR`，
        选择完回来，框框里的值应该就是 `PARENT_DIR` 的路径. 我们还需要**手动在框框的末尾**，打上`/sparrowwhole` 
        最终，确保框框里是`PARENT_DIR/sparrowhole`!

    两个空都填上了，我们点`Clone`， 等待进度条走完，代码就下载下来了。`Git GUI`完成了它的使命，可以关闭了。

3. 安装vscode，打开本地目录，完成准备工作

    从 [vscode官网](https://code.visualstudio.com/) 下载Windows版本的vscode. 安装。（如果已经安装了，可以跳过。）

    打开vscode，直接点击 `open folder`，弹出文件夹浏览窗口，选中刚刚下载的博客文件夹`PARENT_DIR/sparrowhole`，就打开了本地目录。

    接下来，我们要做`切换分支`的操作。

    解释一下，git除了版本控制，还有多分支的功能。分支，英文名为`branch`. 可以从河流来理解branch, 一般主干分支名为`master`, 代表了
    主要的代码；而额外的旁支，可能从`master`分出，用来完成某项特殊的开发，这样它不会影响到主干；当开发完成，这个旁支又可能**合入**
    到主干分支，就像支流汇入主干。

    我们的博客仓库有2个分支，1个自然是主干`master`，还有一个叫`source`.
    这个仓库的分支逻辑与上面典型分支逻辑不同，其实可以将它们看做彼此独立的部分，分支仅仅用来做彼此独立的存储。
    也就是1个文件夹，放了2套不同的文件。
    `master`是部署分支，也就是hexo生成的html文件，它直接用于网站部署。**我们不用管这个分支，它自动由hexo构建**。
    而`source`是源码分支，是用来生成html的源代码，这个是我们需要修改的分支。
    分支切换称为`签出`, 英文`checkout`.

    在第2步里，我们通过git工具下载了仓库，它默认使用主干`master`分支。因此，**在开始编辑前，我们需要先切换到source分支**。

    方法非常简单。
    
    在vscode窗口的最左侧，有一排竖着排列的按钮(称为 `activity bar`)，点击那个1个圈圈分出去2个圈圈的类Y型按钮——它就是集成git的按钮。
    （这个Y型里的圈圈就是版本控制点，分叉就是分支的意思。）
    点击后，会看到`source control:git (或中文的 '源代码管理:GIT')`。
    点击头上的`...`，会弹出1个菜单列表，选择 第二大栏里的第1项 `Checkout to...(或中文的 '签出到')`，接着由弹出一个框框，
    选择其中的`origin/source`. 点击即可（`origin`是远端地址的称呼，可以认为就是Github的地址；
    这里`origin/source`就表示远端的source分支。切换后，会在本地也创建一个source分支，与远端的source分支对应）。

    ![vscode-select](/images/2020-02-23-how-to/vscode_checkout.png)

    到此，我们利用vscode切换到`source`分支，准备工作大工告成！

    > vscode可以配置主题、字体、文件图标等，可以自己根据喜好设置。

### 2. 撰写文章

完成了前面的设置，后面的部分就简单啦。这一节我们介绍如何撰写文章。

一句话说明，在仓库文件夹下的`source/_posts/`文件夹下写一个`xxx.md`的文件，就完成文章撰写。很简单吧~

接下来说一些背景知识： Hexo使用`Markdown`格式作为文章的源格式。它的规则非常简单，可以见
[hexo官网链接的markdown介绍](https://daringfireball.net/projects/markdown/syntax)或者随便搜索一篇文档即可。

> 或者，直接上手写即可，只需要知道要想换行得空一行，`#`是一级标题，`##`是二级标题，`###`是三级标题…… 
> 直接查看本页面的源码也是不错的学习方式~ 这也是本文的一个初衷。

Markdown文件的后缀是`.md`。写完markdown后，hexo生成时会自动将markdown按规则转换为html，于是网页就产生了。

用于Hexo的markdown文件，在文件头部需要写一些额外的信息，这个信息被称为`Front-matter`. 它用来指明文章的标题、写作时间、分类、标签等等属性。

下面用一个例子来详细说明整个撰写流程。

1. 确认本地文件是最新的

    每次写作前，如果忘了本地是否是最新的，最好走一遍git拉取流程。

    在vscode里，最左边的avtivate bar, 点击Y型按钮（后面用`源代码管理`这一标准称谓），
    再点击顶部的`...`, 弹出的菜单里，选择第一个选项 `Pull`，进度条走完就表明完成了。

2. 新建文件

    在vscode里，最左边的activate bar, 点击第一个按钮（`资源管理器`按钮），依次点开`source->_posts`, 
    
    在`_posts`上右键，选择`新建文件`，

    > 如果觉得vscode创建文件不太方便，可以用Windows的资源管理器创建也行。

    填入文件名，如`2020-02-23-开始写作.md`；文件名除了`.md`后缀，其实可以任意取，但是为了自己方便区分，
    最好先写时间（方便排序），再写标题。

3. 撰写内容

    首先要写`Front-matter`部分，它以`---`为第一行，以`---`表示结尾，中间写字段值。
    下面是一个简单示例：

    ```yml
    ---
    title: 开始写作啦
    date: 2020-02-23 
    ---
    ```

    只用写这么点就行，还可以写额外的标签，具体可以见官网： [front-matter](https://hexo.io/zh-cn/docs/front-matter).

    > 注意，front-matter中的`title`才是文章显示时的标题，文件名并不会作为显示标题。

    front-matter后，一般空一行，就是写内容了。这个就自己发挥啦，按照makrdown格式就行。

    > 如果觉得每次都从front-matter写太麻烦，可以在`_posts`之外任意位置建一个模板文件，把front-matter的key先填好
    > 下次要新建时，直接把模板文件复制到`_posts`里，改下文件名和front-matter的value值，然后就可以直接开始写。

4. 插入图片

    如果有图片需要插入，那又分为2步：

    1. 将图片放到仓库的`/source/images`下的某个地方

        一般为了有序，在`/source/images`下再建一个与该博客名称相同，或者时间相同的文件夹，
        然后把图片放进来。
        假设新建文件夹`2020-02-23`，放进来一个图片名字叫`haohao.png`, 那么它相对于仓库的路径就是
        `/source/images/2020-02-23/haohao.png`.

    2. 在markdown中引用该图片

        markdown中引用图片的语法是 `![image-title](image-url)`, 注意这里的`image-url`， 需要去掉`/source`,
        上面的例子，写作

        `![hao-hao](/images/2020-02-23/haohao.png)`

    
到此，文章撰写说明就完成啦。不用一次就写完，它就是一个文件，保存了下次打开继续写就可以啦。

### 3. 发布文章

发布文章就更简单啦~ 只需要把本地改动先存为git的一个版本，再提交这个版本到Github，等1、2分钟，网页就更新咯。

> *'存储为git的一个版本'， 一般叫做 `commit`, 或者 `提交`， 表示将本地改动提交到git版本控制系统。

1. 存储改动为git的一个提交

    > 当然，先保证文件本身已经保存啦

    在vscode里，点击`源代码管理`按钮，这个时候，应该看到下面有一个`更改(CHANGES)`栏，
    里面应该就是刚刚新建或改动的文件名。看到这个，我们才能明确，这个改动在本地是有效的~

    这个时候，注意`更改`之上，`...`栏之下，由一个框框，这个叫做 `提交信息`，每次提交的时候，写上一两句话，
    表示这个提交主要是什么。

    往框框里随便写点内容，比如 “完成撰写”，然后点击上面的`勾勾`，可能弹出一个`当前没有暂存的更改... 是否自动暂存所有更改并提交`，
    选`是`即可。到此，提交完成。


2. 发布到github

    还是在`源代码管理`窗口下，点击`...`，选择 `推送 (Push)`，如果有弹窗，选择`是`即可。
    等进度条走完，就完成了。
    可以去 [github-sparrowhold仓库](https://github.com/sparrowhole/sparrowhole.github.io)
    看看最近的提交信息是不是刚刚提交的，理论上不会有问题。

    然后等1、2分钟，刷新下博客站点，看看刚刚的文章，是不是已经在上面啦~
